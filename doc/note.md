* 我有一个5维波的Echosounder，可以放入水下100米探测5个方向的鱼类资源回波，这5个方向分别是垂直向下（5号换能器），以及向北（1号），向南（2号），向西（3号），向东（4号）四个水平方向，它们分别是90°的关系。每个波束的波束角分别是7°。

* 我把这个Echosounder放到水下100米，刚好周围有很多的鱿鱼，然后用它来探测鱿鱼的资源回波。我需要知道鱿鱼的游泳倾斜角度，以及游泳的方向。

* 需要做的是考虑5维波的波束几何形状，假设鱼在这个空间是以固定的姿态和方向游动的（或者整个立体空间中，所有的鱿鱼都是一个姿态，一个体长大小），那么这些鱿鱼在每个波束下的声波入射角度分别是什么样的，5个波束对应的关系找出来。然后以一个波束为基准，比如垂直向下那个是0°，那么其它4个分别是多少°。这样就只要算5个角度的TS。统计这些TS之间的关系。通过分析5个波束之间的TS差异，就能推断出鱿鱼的游泳倾斜角度。这是一个统计学的概率分布问题。可以先用TS的模型生成数据，加入概率分布函数，然后采样统计分析，做数值模拟，最后，通过实际数据来验证。实际的游泳角度可以再用光学观测（5波束上面加上一个水下摄像头）

* 体长分布，游泳角度，游泳方向都可以用概率分布来进行模拟生成数据，再从中采样。

* 我现在先模拟生成数据，然后再分析。首先我需要知道每个波束对于鱿鱼的入射角关系是多少，假设，鱿鱼是从西向东水平游动的，鱿鱼模拟为一个圆锥体。那么在垂直向下波束下，鱿鱼的入射角是0°，在向西（3号）波束下，鱿鱼的入射角是90°，在向东（4号）波束下，鱿鱼的入射角是-90°，在向北波束（1号）下，鱿鱼的入射角是0°，在向后（2号）波束下，鱿鱼的入射角也是0°。
--
@TS_squid/这里面有4个表格，分别是两条鱿鱼No1胴长19.4cm，体重132.2g，No2胴长17.9cm，体重137.6g的TS测量数据，每条鱿鱼都是用两个宽频系统测量，第一列是频率，第一行是声波入射角度。其中有3个0°的入射角度，因为在试验开始时和试验结束后都测了一下0°的TS，用来校验数据，应该平均一下，这三个0°值是不是算出测量误差？另外，这个测量跟我们前面讨论的一样，声波从背部射入是0°，从尾部射入是-90°，从头部射入是90°。帮我设计一个脚本，读取这4个表格，把所有数据整合到一个netcdf文件中，要说明数据内容


##
好的，现在给我写一个脚本，读取@TS_interpolated_fixed.nc 和@TS_interpolated_0p1kHz.nc 画一个图，当频率为120kHz时，鱿鱼的游泳方向为180°时，游泳角度从-60°到20°以1度为步进的5个换能器的游泳TS的变化曲线（先根据游泳方向和角度算出5个换能器对鱿鱼的声波入射角，然后查询该入射角下的TS值）