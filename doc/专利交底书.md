# 技术交底书：基于姿态补正的五维波束水下目标姿态估算方法及系统

## 一、发明名称

一种基于姿态补正的五维波束水下目标姿态估算方法及系统。

## 二、所属技术领域

本发明涉及水下声学探测技术领域，具体而言，涉及一种利用声学目标强度（Target Strength, TS）数据对水下生物（如鱼类、鱿鱼等）的个体姿态（游泳方向和倾斜角）进行估算的方法与系统，尤其适用于海洋渔业资源精细化评估和行为学研究。

## 三、现有技术（背景技术）

### 3.1 相关技术背景以及最接近的现有技术

原位声学观测是当前海洋渔业调查和生态研究的核心技术之一。通过主动发射声波并接收水中目标（如鱼群）的散射回波，可以非侵入式地获取目标的分布位置、密度、生物量乃至种类等信息。目前，市面上的主流声学探测设备包括单波束、分裂波束和多波束鱼探仪等。

这些技术依据声波探测原理，通过分析回波信号的强度、相位等信息来推断目标的声学特性。不同物种、尺寸、姿态的生物，其声学散射特性（通常用TS值量化）差异显著。因此，精确测量TS值是识别目标种类、估算其大小和密度的基础。

### 3.2 与本发明最相似的现有技术实现方案

与本发明最相似的现有技术方案是采用多波束系统（如水平扫描声呐与垂直鱼探仪结合）对水下目标进行三维空间成像。例如，挪威Simrad、日本Furuno等公司生产的先进多波束设备能够绘制出鱼群的宏观三维形态、移动轨迹和聚集密度。这些系统通过发射和接收数百个窄波束，形成一个扇面覆盖，从而实现对水体的大范围扫描和成像。

在这些系统中，设备通常固定安装于船底，其自身姿态相对稳定。系统能够提供鱼群的整体位置、规模和运动趋势信息。然而，这些系统主要关注鱼群的宏观分布，对于构成鱼群的“个体”的精细化信息，特别是其在三维空间中的姿态（例如，是头朝上/下、倾斜多少度、朝向哪个方向游动），则缺乏有效的探测手段。

### 3.3 现有技术的缺点

现有技术主要存在以下两点核心缺陷：

1.  **无法获取目标个体姿态信息**：无论是单波束、分裂波束还是常规的多波束系统，其主要测量的是目标的空间位置和声学反射强度（TS）。虽然TS值会随目标的姿态变化而剧烈改变，但现有技术通常将这种变化视为一种干扰或不确定性来源，而未将其作为一种可利用的信息源。因此，现有技术无法回答“鱼群中的每一条鱼正朝向哪个方向游动”这类精细化行为学问题，这限制了对鱼类行为模式、集群动力学以及捕捞效率的深入理解。

2.  **探测设备姿态扰动导致数据解译困难**：对于非固定式安装的探测平台（例如，通过吊装方式布放的探测系统、搭载于AUV或拖鱼上的系统），设备本身会受到海流、波浪等环境因素影响而产生摇摆、旋转等姿态变化。此时，声学波束在全局坐标系中的实际指向是不断变化的。现有技术方案若不具备高频次的自身姿态测量与补偿能力，就无法确定每个声学回波的精确空间来源，导致探测到的目标位置失真，更无法利用多波束间的回波差异来反演目标的精细特征。

## 四、发明内容

### 4.1 发明目的

本发明的目的在于克服现有技术的不足，提供一种能够精确估算水下目标个体三维姿态（游泳方向角Yaw和倾斜角Tilt）的方法及其系统。本发明旨在解决两大技术难题：一是如何从多角度的TS观测值中解算出目标的唯一姿态；二是如何消除探测设备自身姿态变化对目标姿态估算带来的影响，确保估算结果的准确性和可靠性。

### 4.2 技术解决方案

为实现上述目的，本发明提出一种结合了五维波束声学探测、设备姿态实时补正和贝叶斯反演算法的技术方案。

**本发明所设计的系统（装置）包括：**

1.  **五维波束换能器阵列**：由五个独立的单波束换能器构成，呈十字形布局。其中四个水平换能器分别指向设备坐标系的前、后、左、右方向，一个垂直换能器指向设备坐标系的正下方。所有换能器同步工作，发射相同频率的声波并接收回波。
2.  **高精度姿态传感器**：内置一个高频采样（如100Hz以上）的惯性测量单元（IMU），通常包括三轴陀螺仪和三轴加速度计。该传感器用于实时测量探测系统本身在全局坐标系下的俯仰角（Pitch）、横滚角（Roll）和航向角（Heading）。
3.  **中央数据处理单元**：负责同步控制五个换能器的发射与接收，采集五个通道的回波数据，并同步记录姿态传感器输出的姿态数据。
4.  **数据存储与传输模块**：用于存储原始回波数据和姿态数据，或通过水声通信/线缆将数据实时传输至上位机。

**本发明所采用的方法（步骤）如下：**

**第一步：数据同步采集**
在每个探测周期（Ping），中央数据处理单元同步触发五个换能器发射声波，并采集各自通道返回的完整回波信号。同时，以毫秒级精度记录下与该Ping对应的设备实时姿态数据（俯仰角$	heta_d$, 横滚角$
otin_d$, 航向角$
otin_d$）。

**第二步：目标识别与TS提取**
对五个通道的回波信号进行处理，识别出同一个单体目标在五个波束中的回波，并从中计算出该目标在五个波束下的目标强度值，记为 ${TS_{North}, TS_{South}, TS_{West}, TS_{East}, TS_{Vertical}}$。同时，计算出四个水平波束相对于垂直波束的TS差异值，记为观测数据集 $D_{obs} = \{\Delta TS_{N-V}, \Delta TS_{S-V}, \Delta TS_{W-V}, \Delta TS_{E-V}\}$.

**第三步：波束向量姿态补正（核心创新点之一）**
1.  首先，定义五个波束在设备本地坐标系下的标称单位向量，例如 $\vec{b}_{V\_local} = [0, 0, -1]^T$。
2.  然后，利用第一步中记录的设备实时姿态数据（$	heta_d, 
otin_d, 
otin_d$），构建一个从设备本地坐标系到全局地理坐标系的旋转矩阵 $R(\theta_d, 
otin_d, 
otin_d)$。
3.  将每个波束的本地向量左乘该旋转矩阵，得到其在全局坐标系下的真实指向向量：$\vec{b}_{i\_global} = R \cdot \vec{b}_{i\_local}$。这一步骤完成了对设备姿态扰动的精确补正，确保了所有后续计算都在统一的全局坐标系下进行。

**第四步：基于贝叶斯反演的目标姿态估算（核心创新点之二）**
该步骤旨在求解在给定TS差异观测值 $D_{obs}$ 的条件下，目标的姿态（游泳方向角 $
otin_t$，倾斜角 $	au_t$）的后验概率分布 $P((
otin_t, 	au_t) | D_{obs})$。
1.  **构建先验模型（查找表LUT）**：离线构建一个描述“目标姿态-TS差异”映射关系的统计模型。该模型通过蒙特卡洛模拟生成：遍历所有可能的目标姿态 $(
otin_t, 	au_t)$，对于每个姿态：
    a.  定义目标的身体中轴线向量 $\vec{S}(
otin_t, 	au_t)$。
    b.  计算 $\vec{S}$ 与五个**已标称固定**的波束向量（例如，全局坐标系下的上、北、东、南、西）的夹角，即入射角 $\alpha_i$。
    c.  利用一个已知的、描述目标声学特性的正向物理模型 $f_{TS}(\alpha)$（可基于经验数据或理论模型建立），计算出五个波束的理论TS值。
    d.  在计算过程中加入各种不确定性（如波束指向误差、TS测量噪声、目标体长变化等）的随机扰动。
    e.  重复上千次模拟，得到在当前姿态下，四个TS差异值的统计分布，并存储其均值 $\mu(\notin_t, 	au_t)$ 和标准差 $\sigma(\notin_t, 	au_t)$。最终形成一个覆盖所有姿態的查找表（LUT）。

2.  **计算似然度**：对于第二步中得到的实时观测数据 $D_{obs}$，遍历LUT中所有的候选姿态 $(
otin_t, 	au_t)$。对于每一个候选姿态，我们利用LUT中存储的该姿态下的TS差异统计量（$\\\mu, \\sigma$），计算出现我们观测到的 $D_{obs}$ 的概率，即似然度 $L(D_{obs} | (
otin_t, 	au_t))$。我们假设各通道噪声独立且服从高斯分布。

3.  **计算后验概率**：根据贝叶斯公式 `后验 ∝ 似然 × 先验`，计算每个候选姿态的后验概率。在没有额外信息时，可假设所有姿态的先验概率相等（均匀先验）。

4.  **姿态估计**：在所有候选姿态中，找到使后验概率最大化的姿态 $(\hat{
otin}_t, \hat{	au}_t)$，将其作为目标的最佳估计姿态。
    $$ (\hat{
otin}_t, \hat{	au}_t) = \underset{(
otin_t, 	au_t)}{\arg\max} \, P((
otin_t, 	au_t) | D_{obs}) $$
    *请注意*：在实时计算时，贝叶斯反演所用的波束向量，应是经过第三步姿态补正后的**真实波束向量** $\vec{b}_{i\_global}$，而非固定的全局坐标向量。这意味着，LUT需要被动态地、实时地根据设备的姿态进行查询和匹配，或者实时计算似然度时，将目标姿态和设备姿态共同作为变量。一个更高效的实现方式是：将观测到的目标TS特征，通过逆旋转矩阵$R^{-1}$变换回设备本地坐标系，然后与一个固定的、在设备本地坐标系下建立的LUT进行比较。

### 4.3 技术效果

与现有技术相比，本发明具有以下有益效果：
1.  **实现了目标个体姿态的精确估计**：首次提出了一种从多角度TS测量值反演目标三维姿态的方法，能够提供鱼类行为学研究所需的游泳方向（Yaw）和倾斜角（Tilt）等关键精细化信息，填补了现有技术的空白。
2.  **极大地提高了探测精度和可靠性**：通过内置陀螺仪等姿态传感器，实时补偿因设备摇晃带来的波束指向误差，确保了声学数据空间基准的统一和准确。无论设备如何晃动，都能精确知道每个回波的来源方向，这是实现精确姿态反演的根本保障。
3.  **扩展了设备的应用场景**：由于具备姿态自校正能力，本发明所述的系统不再局限于固定的船底安装，可广泛应用于需要吊放、拖曳或搭载于无人平台的动态场景中，极大增强了部署的灵活性和对复杂海洋环境的适应性。
4.  **为渔业科学与智能捕捞提供了新维度数据**：获取的鱼群个体姿态分布信息，可用于分析鱼类的集群行为、昼夜垂直移动模式、对环境变化的响应等，为渔业资源评估模型的精细化、捕捞策略的智能化提供前所未有的数据支持。

## 五、附图及附图的简单说明

（可在此处插入系统框图）

**图1：本发明系统结构与数据处理流程框图**

框图说明：
-   **硬件层**：包括五维波束换能器阵列、姿态传感器（IMU）、中央数据处理单元和电源/通信模块。
-   **数据采集层**：姿态传感器和换能器阵列分别采集设备姿态数据和五通道回波数据，并打上同步时间戳。
-   **数据处理层**：
    -   **波束姿态补正模块**：接收原始姿态数据，计算实时旋转矩阵，输出补正后的全局波束向量。
    -   **TS提取与差异计算模块**：从回波中提取五个TS值，并计算TS差异，形成观测量。
    -   **贝叶斯反演模块**：结合补正后的波束向量、TS观测量以及预置的LUT，计算后验概率分布图。
-   **结果输出层**：输出概率最高的姿态（Yaw, Tilt）作为最终估计结果。

## 六、具体实施方式

以下结合一个具体应用场景——大洋光诱鱿钓作业，对本发明的实施方式进行详细说明。

1.  **设备布放与数据采集**：将本发明所述的探测系统通过船载吊机布放至鱿鱼聚集的典型水层（如50-150米）。系统启动后，五个换能器以1Hz的频率同步进行Ping操作，同时，内置的IMU以100Hz的频率记录设备的俯仰、横滚和航向角。数据通过光电复合缆实时上传至船上工作站。

2.  **数据实时处理**：
    a.  船上工作站接收到每一Ping的数据包，其中包含五个通道的回波数据和与之对应的一组姿态数据（$	heta_d, 
otin_d, 
otin_d$）。
    b.  软件系统首先对回波数据进行单体目标检测，识别出同一个鱿鱼个体在五个波束中的回波信号，并计算出其TS值和TS差异值 $D_{obs}$。
    c.  软件系统调用**姿态补正模块**。根据接收到的（$	heta_d, 
otin_d, 
otin_d$），计算出旋转矩阵$R$，并将五个波束的标称向量转换为全局坐标系下的真实指向向量 {$\\vec{b}_{i\_global}$}。
    d.  接下来，进入**贝叶斯反演模块**。该模块已预先加载了一个针对目标鱿鱼的“姿态-TS差异”统计查找表（LUT）。该LUT是基于实验室水箱中测得的不同姿态鱿鱼的TS数据，或通过声学模型（如KRM模型）仿真生成的。
    e.  对于识别出的鱿鱼个体，反演模块遍历所有可能的鱿鱼姿态（例如，Yaw从0°到359°，Tilt从-90°到+90°，步长均为1°）。对每一个候选姿态 $(
otin_t, 	au_t)$，计算其身体中轴线向量 $\vec{S}(
otin_t, 	au_t)$ 与五个已补正的真实波束向量 {$\\vec{b}_{i\_global}$} 的夹角，得到一组理论入射角。
    f.  根据这组理论入射角，查询LUT或通过正向模型计算，得到一组理论上的TS差异值。
    g.  将这组理论TS差异值与实测的TS差异值 $D_{obs}$ 进行比较，计算似然度。
    h.  最终，在所有候选姿态中，确定后验概率最高的姿态 $(\hat{
otin}_t, \hat{	au}_t)$，即为该鱿鱼个体的实时姿态估计值。

3.  **结果呈现与应用**：
    在显示界面上，除了传统的回波图，还可以三维形式实时可视化每个被探测到的鱿鱼个体的空间位置，并用一个带箭头的模型表示其游泳方向和倾斜姿态。作业人员可以据此判断鱿鱼群是否活跃、是否被灯光吸引向上游动、主要的逃逸方向等，从而做出更精准的下钩深度、作业时机等决策，显著提升捕捞效率。
