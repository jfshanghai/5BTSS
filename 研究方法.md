# 模拟五波束声呐探测鱿鱼姿态的研究方法

本文档旨在整理和明确通过数值模拟方法，利用五波束声呐回波数据反演鱿鱼游泳姿态（方向与倾斜角）的研究思路。

## 1. 核心问题

利用一个包含垂直向下和东、南、西、北四个水平方向的五波束声呐，通过分析同一目标在五个波束下的目标强度（TS）差异，反演出目标的游泳姿态。

## 2. 坐标系统与角度定义

为了精确定量分析，我们建立一套统一的坐标系统和角度定义。

### 2.1 世界坐标系 (World Coordinate System)

这是一个固定的、以地球为参考的右手坐标系。

- **原点 (0, 0, 0)**: 声呐换能器的几何中心。
- **+X 轴**: 指向 **正东 (East)**。
- **+Y 轴**: 指向 **正北 (North)**。
- **+Z 轴**: 指向 **正上方 (Up)**。

### 2.2 波束向量 (Beam Vectors)

根据世界坐标系，五个波束的中心轴线方向向量 `B` 定义如下：

- `B_N` (北, #1): `(0, 1, 0)`
- `B_S` (南, #2): `(0, -1, 0)`
- `B_W` (西, #3): `(-1, 0, 0)`
- `B_E` (东, #4): `(1, 0, 0)`
- `B_V` (垂直, #5): `(0, 0, -1)` (指向下方)

### 2.3 鱿鱼姿态角 (Squid Orientation Angles)

我们使用两个角度来完整描述鱿鱼在三维空间中的身体姿态：

1.  **方向角 (Yaw / Heading), `ψ` (psi)**: 鱿鱼在**水平面**内的游泳方向。定义为从X轴（正东）开始，**逆时针**旋转的角度 (0°~360°)。
    - `ψ = 0°`: 朝向正东。
    - `ψ = 90°`: 朝向正北。
    - `ψ = 180°`: 朝向正西。

2.  **倾斜角 (Tilt / Pitch), `τ` (tau)**: 鱿鱼身体长轴与**水平面**的夹角 (-90°~90°)。
    - `τ = 0°`: 水平游泳。
    - `τ > 0°`: 头部朝上，向上游。
    - `τ < 0°`: 头部朝下，向下游。

### 2.4 鱿鱼姿态向量 (Squid Orientation Vector)

基于 `ψ` 和 `τ`，代表鱿鱼身体长轴（从尾到头）的单位向量 `S` 可以通过球面坐标转换得到：

`S = ( cos(τ) * cos(ψ),   cos(τ) * sin(ψ),   sin(τ) )`

### 2.5 标准入射角 (Standard Incidence Angle `θ`)

目标强度TS的计算依赖于标准的入射角 `θ`，即**声波传播方向**与**目标身体长轴**之间的夹角。这与我们最初讨论的非标准定义不同，但可以通过向量运算统一起来。

对于任意一个波束（向量 `B`）和处于特定姿态的鱿鱼（向量 `S`），它们之间的标准入射角 `θ` 可通过向量点积（Dot Product）计算：

`θ = arccos( B · S )`

因此，鱿鱼在五个波束下的入射角分别为：

- `θ_N = arccos( cos(τ)sin(ψ) )`
- `θ_S = arccos( -cos(τ)sin(ψ) )`
- `θ_W = arccos( -cos(τ)cos(ψ) )`
- `θ_E = arccos( cos(τ)cos(ψ) )`
- `θ_V = arccos( -sin(τ) )`

## 3. 数值模拟流程

1.  **生成模拟群体**: 模拟一个大规模的鱿鱼群体（例如，N=10,000）。为群体中的每一只鱿鱼 `i`，从预设的概率分布中随机抽取一组参数：
    - **方向角 `ψ_i`**: 可从 `[0, 360)` 的均匀分布中抽样（代表方向随机），或从冯·米塞斯分布中抽样（代表有主导方向）。
    - **倾斜角 `τ_i`**: 可从一个以0°为中心的正态分布中抽样（例如，`N(0, 15²)`，代表多数个体在±15°内游动）。
    - **体长 `L_i`**: 可从一个符合实际观测的正态或对数正态分布中抽样。

2.  **单体计算循环**: 对群体中的每一只鱿鱼 `i` 执行以下计算：
    a. 根据其 `ψ_i` 和 `τ_i` 计算出身体姿态向量 `S_i`。
    b. 利用点积公式，计算出其在五个波束下的标准入射角 `θ_{N,i}, θ_{S,i}, θ_{W,i}, θ_{E,i}, θ_{V,i}`。
    c. 将这五个 `θ` 角和体长 `L_i` 代入一个合适的TS模型（例如，基于圆锥体的KRM模型），计算出五个对应的目标强度 `TS_{N,i}, TS_{S,i}, TS_{W,i}, TS_{E,i}, TS_{V,i}`。
    d. **引入波束内角度不确定性**: 对于计算出的每个标准入射角 `θ`，我们给它加上一个随机扰动 `ε`，得到最终用于计算TS的角度 `θ_final = θ + ε`。
        - 这个扰动 `ε` 从一个概率密度函数（PDF）中抽样得出。
        - 该PDF的形态由换能器的波束方向图（Beam Pattern）决定。作为一个简化，可以假设它是一个均值为0的正态分布，其标准差与波束宽度相关（例如，对于7°波束，大部分误差应落在±3.5°范围内）。

3.  **统计分析与反演**:
    a. 模拟完成后，得到一个包含输入参数 (`ψ`, `τ`, `L`) 和输出结果 (`TS_N`...`TS_V`) 的大型数据集。
    b. 重点分析五列TS值之间的关系，例如计算它们之间的差值（如 `ΔTS_WE = TS_W - TS_E`）或其它统计特征。
    c. 建立一个从“TS特征”到“姿态角”的映射模型（例如，查找表、多元回归模型或机器学习模型）。此模型将是最终用于从实测数据反演姿态的工具。

## 4. 未来优化方向

- **横滚角 (Roll Angle `φ`)**: 引入鱿鱼绕自身长轴旋转的角度，构建更完整的6自由度模型。
- **波束宽度 (Beam Pattern)**: 考虑7°的波束角，目标可能在波束边缘被探测，其入射角会偏离中心轴线的计算值，这会给TS带来额外的方差。
- **TS模型**: 采用更精细的鱿鱼TS模型，以提高模拟的准确性。
